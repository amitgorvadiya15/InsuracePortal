<!DOCTYPE html>
<html class="no-js" lang="en">

<!-- Mirrored from www.simplybusiness.co.uk/about-us/tech/2014/11/hackathon-building-a-sales-leaderboard-with-rabbitfeed-and-websockets/ by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 04 Dec 2017 10:13:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"b747ade770","applicationID":"71452593","transactionName":"cVtfFhENWQlSQRxrXlxVRRACTWYAUldKAg1zRlIKChRQFg0JZ11UWht2JzdCVAdYRkcQCAhoHB5GUG4hU24aTUQdQFQBC00dPmkcDBtqGR0eSjg8GloUbhgRGBpvb01cQWhOHg==","queueTime":0,"applicationTime":26,"ttGuid":"","agentToken":null,"agent":""}</script>
<script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={xpid:"VQUCVFNWGwQBUFRQAggE"};window.NREUM||(NREUM={}),__nr_require=function(t,n,e){function r(e){if(!n[e]){var o=n[e]={exports:{}};t[e][0].call(o.exports,function(n){var o=t[e][1][n];return r(o||n)},o,o.exports)}return n[e].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<e.length;o++)r(e[o]);return r}({1:[function(t,n,e){function r(t){try{s.console&&console.log(t)}catch(n){}}var o,i=t("ee"),a=t(15),s={};try{o=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(s.console=!0,o.indexOf("dev")!==-1&&(s.dev=!0),o.indexOf("nr_dev")!==-1&&(s.nrDev=!0))}catch(c){}s.nrDev&&i.on("internal-error",function(t){r(t.stack)}),s.dev&&i.on("fn-err",function(t,n,e){r(e.stack)}),s.dev&&(r("NR AGENT IN DEVELOPMENT MODE"),r("flags: "+a(s,function(t,n){return t}).join(", ")))},{}],2:[function(t,n,e){function r(t,n,e,r,o){try{d?d-=1:i("err",[o||new UncaughtException(t,n,e)])}catch(s){try{i("ierr",[s,c.now(),!0])}catch(u){}}return"function"==typeof f&&f.apply(this,a(arguments))}function UncaughtException(t,n,e){this.message=t||"Uncaught error with no additional information",this.sourceURL=n,this.line=e}function o(t){i("err",[t,c.now()])}var i=t("handle"),a=t(16),s=t("ee"),c=t("loader"),f=window.onerror,u=!1,d=0;c.features.err=!0,t(1),window.onerror=r;try{throw new Error}catch(l){"stack"in l&&(t(8),t(7),"addEventListener"in window&&t(5),c.xhrWrappable&&t(9),u=!0)}s.on("fn-start",function(t,n,e){u&&(d+=1)}),s.on("fn-err",function(t,n,e){u&&(this.thrown=!0,o(e))}),s.on("fn-end",function(){u&&!this.thrown&&d>0&&(d-=1)}),s.on("internal-error",function(t){i("ierr",[t,c.now(),!0])})},{}],3:[function(t,n,e){t("loader").features.ins=!0},{}],4:[function(t,n,e){function r(t){}if(window.performance&&window.performance.timing&&window.performance.getEntriesByType){var o=t("ee"),i=t("handle"),a=t(8),s=t(7),c="learResourceTimings",f="addEventListener",u="resourcetimingbufferfull",d="bstResource",l="resource",p="-start",h="-end",m="fn"+p,w="fn"+h,v="bstTimer",y="pushState",g=t("loader");g.features.stn=!0,t(6);var b=NREUM.o.EV;o.on(m,function(t,n){var e=t[0];e instanceof b&&(this.bstStart=g.now())}),o.on(w,function(t,n){var e=t[0];e instanceof b&&i("bst",[e,n,this.bstStart,g.now()])}),a.on(m,function(t,n,e){this.bstStart=g.now(),this.bstType=e}),a.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),this.bstType])}),s.on(m,function(){this.bstStart=g.now()}),s.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),"requestAnimationFrame"])}),o.on(y+p,function(t){this.time=g.now(),this.startPath=location.pathname+location.hash}),o.on(y+h,function(t){i("bstHist",[location.pathname+location.hash,this.startPath,this.time])}),f in window.performance&&(window.performance["c"+c]?window.performance[f](u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance["c"+c]()},!1):window.performance[f]("webkit"+u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance["webkitC"+c]()},!1)),document[f]("scroll",r,{passive:!0}),document[f]("keypress",r,!1),document[f]("click",r,!1)}},{}],5:[function(t,n,e){function r(t){for(var n=t;n&&!n.hasOwnProperty(u);)n=Object.getPrototypeOf(n);n&&o(n)}function o(t){s.inPlace(t,[u,d],"-",i)}function i(t,n){return t[1]}var a=t("ee").get("events"),s=t(18)(a,!0),c=t("gos"),f=XMLHttpRequest,u="addEventListener",d="removeEventListener";n.exports=a,"getPrototypeOf"in Object?(r(document),r(window),r(f.prototype)):f.prototype.hasOwnProperty(u)&&(o(window),o(f.prototype)),a.on(u+"-start",function(t,n){var e=t[1],r=c(e,"nr@wrapped",function(){function t(){if("function"==typeof e.handleEvent)return e.handleEvent.apply(e,arguments)}var n={object:t,"function":e}[typeof e];return n?s(n,"fn-",null,n.name||"anonymous"):e});this.wrapped=t[1]=r}),a.on(d+"-start",function(t){t[1]=this.wrapped||t[1]})},{}],6:[function(t,n,e){var r=t("ee").get("history"),o=t(18)(r);n.exports=r,o.inPlace(window.history,["pushState","replaceState"],"-")},{}],7:[function(t,n,e){var r=t("ee").get("raf"),o=t(18)(r),i="equestAnimationFrame";n.exports=r,o.inPlace(window,["r"+i,"mozR"+i,"webkitR"+i,"msR"+i],"raf-"),r.on("raf-start",function(t){t[0]=o(t[0],"fn-")})},{}],8:[function(t,n,e){function r(t,n,e){t[0]=a(t[0],"fn-",null,e)}function o(t,n,e){this.method=e,this.timerDuration=isNaN(t[1])?0:+t[1],t[0]=a(t[0],"fn-",this,e)}var i=t("ee").get("timer"),a=t(18)(i),s="setTimeout",c="setInterval",f="clearTimeout",u="-start",d="-";n.exports=i,a.inPlace(window,[s,"setImmediate"],s+d),a.inPlace(window,[c],c+d),a.inPlace(window,[f,"clearImmediate"],f+d),i.on(c+u,r),i.on(s+u,o)},{}],9:[function(t,n,e){function r(t,n){d.inPlace(n,["onreadystatechange"],"fn-",s)}function o(){var t=this,n=u.context(t);t.readyState>3&&!n.resolved&&(n.resolved=!0,u.emit("xhr-resolved",[],t)),d.inPlace(t,y,"fn-",s)}function i(t){g.push(t),h&&(x?x.then(a):w?w(a):(E=-E,O.data=E))}function a(){for(var t=0;t<g.length;t++)r([],g[t]);g.length&&(g=[])}function s(t,n){return n}function c(t,n){for(var e in t)n[e]=t[e];return n}t(5);var f=t("ee"),u=f.get("xhr"),d=t(18)(u),l=NREUM.o,p=l.XHR,h=l.MO,m=l.PR,w=l.SI,v="readystatechange",y=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],g=[];n.exports=u;var b=window.XMLHttpRequest=function(t){var n=new p(t);try{u.emit("new-xhr",[n],n),n.addEventListener(v,o,!1)}catch(e){try{u.emit("internal-error",[e])}catch(r){}}return n};if(c(p,b),b.prototype=p.prototype,d.inPlace(b.prototype,["open","send"],"-xhr-",s),u.on("send-xhr-start",function(t,n){r(t,n),i(n)}),u.on("open-xhr-start",r),h){var x=m&&m.resolve();if(!w&&!m){var E=1,O=document.createTextNode(E);new h(a).observe(O,{characterData:!0})}}else f.on("fn-end",function(t){t[0]&&t[0].type===v||a()})},{}],10:[function(t,n,e){function r(t){var n=this.params,e=this.metrics;if(!this.ended){this.ended=!0;for(var r=0;r<d;r++)t.removeEventListener(u[r],this.listener,!1);if(!n.aborted){if(e.duration=a.now()-this.startTime,4===t.readyState){n.status=t.status;var i=o(t,this.lastSize);if(i&&(e.rxSize=i),this.sameOrigin){var c=t.getResponseHeader("X-NewRelic-App-Data");c&&(n.cat=c.split(", ").pop())}}else n.status=0;e.cbTime=this.cbTime,f.emit("xhr-done",[t],t),s("xhr",[n,e,this.startTime])}}}function o(t,n){var e=t.responseType;if("json"===e&&null!==n)return n;var r="arraybuffer"===e||"blob"===e||"json"===e?t.response:t.responseText;return h(r)}function i(t,n){var e=c(n),r=t.params;r.host=e.hostname+":"+e.port,r.pathname=e.pathname,t.sameOrigin=e.sameOrigin}var a=t("loader");if(a.xhrWrappable){var s=t("handle"),c=t(11),f=t("ee"),u=["load","error","abort","timeout"],d=u.length,l=t("id"),p=t(14),h=t(13),m=window.XMLHttpRequest;a.features.xhr=!0,t(9),f.on("new-xhr",function(t){var n=this;n.totalCbs=0,n.called=0,n.cbTime=0,n.end=r,n.ended=!1,n.xhrGuids={},n.lastSize=null,p&&(p>34||p<10)||window.opera||t.addEventListener("progress",function(t){n.lastSize=t.loaded},!1)}),f.on("open-xhr-start",function(t){this.params={method:t[0]},i(this,t[1]),this.metrics={}}),f.on("open-xhr-end",function(t,n){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&n.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid)}),f.on("send-xhr-start",function(t,n){var e=this.metrics,r=t[0],o=this;if(e&&r){var i=h(r);i&&(e.txSize=i)}this.startTime=a.now(),this.listener=function(t){try{"abort"===t.type&&(o.params.aborted=!0),("load"!==t.type||o.called===o.totalCbs&&(o.onloadCalled||"function"!=typeof n.onload))&&o.end(n)}catch(e){try{f.emit("internal-error",[e])}catch(r){}}};for(var s=0;s<d;s++)n.addEventListener(u[s],this.listener,!1)}),f.on("xhr-cb-time",function(t,n,e){this.cbTime+=t,n?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof e.onload||this.end(e)}),f.on("xhr-load-added",function(t,n){var e=""+l(t)+!!n;this.xhrGuids&&!this.xhrGuids[e]&&(this.xhrGuids[e]=!0,this.totalCbs+=1)}),f.on("xhr-load-removed",function(t,n){var e=""+l(t)+!!n;this.xhrGuids&&this.xhrGuids[e]&&(delete this.xhrGuids[e],this.totalCbs-=1)}),f.on("addEventListener-end",function(t,n){n instanceof m&&"load"===t[0]&&f.emit("xhr-load-added",[t[1],t[2]],n)}),f.on("removeEventListener-end",function(t,n){n instanceof m&&"load"===t[0]&&f.emit("xhr-load-removed",[t[1],t[2]],n)}),f.on("fn-start",function(t,n,e){n instanceof m&&("onload"===e&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=a.now()))}),f.on("fn-end",function(t,n){this.xhrCbStart&&f.emit("xhr-cb-time",[a.now()-this.xhrCbStart,this.onload,n],n)})}},{}],11:[function(t,n,e){n.exports=function(t){var n=document.createElement("a"),e=window.location,r={};n.href=t,r.port=n.port;var o=n.href.split("://");!r.port&&o[1]&&(r.port=o[1].split("../../../../../index.html")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=n.hostname||e.hostname,r.pathname=n.pathname,r.protocol=o[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname);var i=!n.protocol||":"===n.protocol||n.protocol===e.protocol,a=n.hostname===document.domain&&n.port===e.port;return r.sameOrigin=i&&(!n.hostname||a),r}},{}],12:[function(t,n,e){function r(){}function o(t,n,e){return function(){return i(t,[f.now()].concat(s(arguments)),n?null:this,e),n?void 0:this}}var i=t("handle"),a=t(15),s=t(16),c=t("ee").get("tracer"),f=t("loader"),u=NREUM;"undefined"==typeof window.newrelic&&(newrelic=u);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",p=l+"ixn-";a(d,function(t,n){u[n]=o(l+n,!0,"api")}),u.addPageAction=o(l+"addPageAction",!0),u.setCurrentRouteName=o(l+"routeName",!0),n.exports=newrelic,u.interaction=function(){return(new r).get()};var h=r.prototype={createTracer:function(t,n){var e={},r=this,o="function"==typeof n;return i(p+"tracer",[f.now(),t,e],r),function(){if(c.emit((o?"":"no-")+"fn-start",[f.now(),r,o],e),o)try{return n.apply(this,arguments)}finally{c.emit("fn-end",[f.now()],e)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,n){h[n]=o(p+n)}),newrelic.noticeError=function(t){"string"==typeof t&&(t=new Error(t)),i("err",[t,f.now()])}},{}],13:[function(t,n,e){n.exports=function(t){if("string"==typeof t&&t.length)return t.length;if("object"==typeof t){if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if(!("undefined"!=typeof FormData&&t instanceof FormData))try{return JSON.stringify(t).length}catch(n){return}}}},{}],14:[function(t,n,e){var r=0,o=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);o&&(r=+o[1]),n.exports=r},{}],15:[function(t,n,e){function r(t,n){var e=[],r="",i=0;for(r in t)o.call(t,r)&&(e[i]=n(r,t[r]),i+=1);return e}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],16:[function(t,n,e){function r(t,n,e){n||(n=0),"undefined"==typeof e&&(e=t?t.length:0);for(var r=-1,o=e-n||0,i=Array(o<0?0:o);++r<o;)i[r]=t[n+r];return i}n.exports=r},{}],17:[function(t,n,e){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],18:[function(t,n,e){function r(t){return!(t&&t instanceof Function&&t.apply&&!t[a])}var o=t("ee"),i=t(16),a="nr@original",s=Object.prototype.hasOwnProperty,c=!1;n.exports=function(t,n){function e(t,n,e,o){function nrWrapper(){var r,a,s,c;try{a=this,r=i(arguments),s="function"==typeof e?e(r,a):e||{}}catch(f){l([f,"",[r,a,o],s])}u(n+"start",[r,a,o],s);try{return c=t.apply(a,r)}catch(d){throw u(n+"err",[r,a,d],s),d}finally{u(n+"end",[r,a,c],s)}}return r(t)?t:(n||(n=""),nrWrapper[a]=t,d(t,nrWrapper),nrWrapper)}function f(t,n,o,i){o||(o="");var a,s,c,f="-"===o.charAt(0);for(c=0;c<n.length;c++)s=n[c],a=t[s],r(a)||(t[s]=e(a,f?s+o:o,i,s))}function u(e,r,o){if(!c||n){var i=c;c=!0;try{t.emit(e,r,o,n)}catch(a){l([a,e,r,o])}c=i}}function d(t,n){if(Object.defineProperty&&Object.keys)try{var e=Object.keys(t);return e.forEach(function(e){Object.defineProperty(n,e,{get:function(){return t[e]},set:function(n){return t[e]=n,n}})}),n}catch(r){l([r])}for(var o in t)s.call(t,o)&&(n[o]=t[o]);return n}function l(n){try{t.emit("internal-error",n)}catch(e){}}return t||(t=o),e.inPlace=f,e.flag=a,e}},{}],ee:[function(t,n,e){function r(){}function o(t){function n(t){return t&&t instanceof r?t:t?c(t,s,i):i()}function e(e,r,o,i){if(!l.aborted||i){t&&t(e,r,o);for(var a=n(o),s=h(e),c=s.length,f=0;f<c;f++)s[f].apply(a,r);var d=u[y[e]];return d&&d.push([g,e,r,a]),a}}function p(t,n){v[t]=h(t).concat(n)}function h(t){return v[t]||[]}function m(t){return d[t]=d[t]||o(e)}function w(t,n){f(t,function(t,e){n=n||"feature",y[e]=n,n in u||(u[n]=[])})}var v={},y={},g={on:p,emit:e,get:m,listeners:h,context:n,buffer:w,abort:a,aborted:!1};return g}function i(){return new r}function a(){(u.api||u.feature)&&(l.aborted=!0,u=l.backlog={})}var s="nr@context",c=t("gos"),f=t(15),u={},d={},l=n.exports=o();l.backlog=u},{}],gos:[function(t,n,e){function r(t,n,e){if(o.call(t,n))return t[n];var r=e();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return t[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(t,n,e){function r(t,n,e,r){o.buffer([t],r),o.emit(t,n,e)}var o=t("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(t,n,e){function r(t){var n=typeof t;return!t||"object"!==n&&"function"!==n?-1:t===window?0:a(t,i,function(){return o++})}var o=1,i="nr@id",a=t("gos");n.exports=r},{}],loader:[function(t,n,e){function r(){if(!x++){var t=b.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&n))return u.abort();f(y,function(n,e){t[n]||(t[n]=e)}),c("mark",["onload",a()+b.offset],null,"api");var e=l.createElement("script");e.src="https://"+t.agent,n.parentNode.insertBefore(e,n)}}function o(){"complete"===l.readyState&&i()}function i(){c("mark",["domContent",a()+b.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(s=Math.max((new Date).getTime(),s))-b.offset}var s=(new Date).getTime(),c=t("handle"),f=t(15),u=t("ee"),d=window,l=d.document,p="addEventListener",h="attachEvent",m=d.XMLHttpRequest,w=m&&m.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:m,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1044.min.js"},g=m&&w&&w[p]&&!/CriOS/.test(navigator.userAgent),b=n.exports={offset:s,now:a,origin:v,features:{},xhrWrappable:g};t(12),l[p]?(l[p]("DOMContentLoaded",i,!1),d[p]("load",r,!1)):(l[h]("onreadystatechange",o),d[h]("onload",r)),c("mark",["firstbyte",s],null,"api");var x=0,E=t(17)},{}]},{},["loader",2,10,4,3]);</script>
<meta charset="utf-8">
<title>Hackathon: Building a Sales Leaderboard with RabbitFeed and Websockets</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport">
<meta content="index, follow" name="robots">
<meta content="Hackathon: Building a Sales Leaderboard with RabbitFeed and Websockets | company name" name="description">
<meta content="Hackathon: Building a Sales Leaderboard with RabbitFeed and Websockets" property="og:title">
<meta content="article" property="og:type">
<meta content="https://www.simplybusiness.co.uk/about-us/tech/2014/11/hackathon-building-a-sales-leaderboard-with-rabbitfeed-and-websockets/" property="og:url">
<meta content="https://www.simplybusiness.co.uk/assets/social/simply_opengraph.png?v2" property="og:image">
<meta content="" property="og:description">
<meta content="summary_large_image" name="twitter:card">
<meta content="@simplybusiness" name="twitter:site">
<meta content="@simplybusiness" name="twitter:creator">
<link href="index.html" rel="canonical">
<meta content="authenticity_token" name="csrf-param">
<meta content="uywYjpi5zmVJaEGkgj4drxoluLjiJjs0zTscAzgRPWA=" name="csrf-token">
<link as="font" crossorigin="anonymous" href="../../../../../assets/bijou/museosans_500-5e970f19a7bd56681ccffee58a97772a148c314440e6549254733ef24a3c9f66.woff2" rel="preload" type="font/woff2">
<link as="font" crossorigin="anonymous" href="../../../../../assets/bijou/museosans_700-b3455e5afa9446a79ada31b9a416de55705fe7e7579989d1e3d6669c224a0bbc.woff2" rel="preload" type="font/woff2">
<link as="font" crossorigin="anonymous" href="../../../../../assets/bijou/museosansrounded_500-d1a96cb01de35edb2d86f7cbb3dd760310896e4f0cc7f0006e014b19c841b2d5.woff2" rel="preload" type="font/woff2">
<link as="font" crossorigin="anonymous" href="../../../../../assets/bijou/museosansrounded_700-205bdf3f5255bae942d055addbb1b09a6ba24b6a8440c688661fa524098745c1.woff2" rel="preload" type="font/woff2">

<link rel="stylesheet" href="../../../../../assets/app-1bf9710e98e8db69f25ae65e22f0a1cec3560d2d0d40a4d9528b872be60e937f.css">
<script src="../../../../../assets/app_head-fee1c8d1c4f037c1f4c940a637d8cd0a8879ab2faf9639ef06824e78ff0e1276.js"></script>
<script id="snippet-snowplow">
window.snowplowHelper = new SnowplowHelper({mainEventsCollector: "d1f6ajd7ltcrsx", bronzeEventsCollector: "d1y70ye8b3qgl6", avalancheCollector: "avalanche.simplybusiness.co.uk", cookieDomain: "simplybusiness.co.uk", appId: "uk-seedy"}).trackPageView();
</script>
<script id="snippet-bing">
(function(w,d,t,r,u){var f,n,i;w[u]=w[u]||[],f=function(){var o={ti:"5561972"};o.q=w[u],w[u]=new UET(o),w[u].push("pageLoad")},n=d.createElement(t),n.src=r,n.async=1,n.onload=n.onreadystatechange=function(){var s=this.readyState;s&&s!=="loaded"&&s!=="complete"||(f(),n.onload=n.onreadystatechange=null)},i=d.getElementsByTagName(t)[0],i.parentNode.insertBefore(n,i)})(window,document,"script","../../../../../../bat.bing.com/bat.js","uetq");
</script>
<noscript>
<img height="0" src="http://bat.bing.com/action/0?ti=5561972&amp;Ver=2" style="display:none; visibility: hidden;" width="0">
</noscript>
<script id="snippet-ga">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','../../../../../../www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-8804762-6', 'auto');
ga('require', 'displayfeatures');
ga('send', 'pageview');
</script>
<script id="snippet-facebook">
!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
document,'script','../../../../../../connect.facebook.net/en_US/fbevents.js');
fbq('init', '1451594908471230');
fbq('track', 'PageView');
fbq('trackCustom', 'UV');
</script>
<noscript>
<img height="1" src="https://www.facebook.com/tr?id=1451594908471230&amp;ev=PageView&amp;noscript=1" style="display:none" width="1">
</noscript>




<link href="../../../../../assets/bijou/favicon-e0e837edfd0650eeac6fdfd867d83745e6162b86a6edc3cb4f7eeae2b2d73aef.ico" rel="shortcut icon" type="image/vnd.microsoft.icon">
<link href="../../../../../assets/bijou/apple-icon-57x57-883fb33d5cf499cd7963527151cacbc2424428a35de4f745eeaa04810c5c95e8.png" rel="apple-touch-icon" sizes="57x57">
<link href="../../../../../assets/bijou/apple-icon-76x76-d405761bd30bd7a9039e9fb213c6f3c44f67e9d6c777e8b9cf30e1ecb57a9364.png" rel="apple-touch-icon" sizes="76x76">
<link href="../../../../../assets/bijou/apple-icon-120x120-64e89542bd90198b0978b07a45f61531d2231f632aa5bf1c716859c78f95b631.png" rel="apple-touch-icon" sizes="120x120">
<link href="../../../../../assets/bijou/apple-icon-152x152-1823375fa998e626ae10f3219d0c71ee4ff7e77f7fc3f47323801925859c6e14.png" rel="apple-touch-icon" sizes="152x152">
<link href="../../../../../assets/bijou/apple-icon-167x167-dc27d424ae184f34cbe4afa158929f59375cfc98477e201f3eb1fced390f0b23.png" rel="apple-touch-icon" sizes="167x167">
<link href="../../../../../assets/bijou/apple-icon-180x180-cfb96d969435ef742153d9b92b7327b0720fa95f3ac905c2cd47cd1731b91e2c.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../../../assets/bijou/icon-192x192-bd2f830632266cad764c388c8d11d7e9aea41bf8e8485bebf1209ac501f9e756.png" rel="icon" sizes="192x192">
<meta content="company name" name="apple-mobile-web-app-title">
</head>
<body class="template-article" itemscope itemtype="https://schema.org/InsuranceAgency">




<header class="site-header" data-module="masthead">
<div class="site-header__top clearfix">
<div class="grid-wrapper">
<div class="site-header-logo">
<div class="site-header-logo__gradient js-has-css-animation"></div>
<a class="site-header-logo__link logo" href="../../../../../index.html" itemprop="url">
company name - Insurance for your business
</a>
</div>
<div class="has-nav site-header__customer-service">
<div class="mobile-hide">
<strong class="site-header__phone-number qa-customer-service-number tel" id="customer-service-number" itemprop="telephone">0333 014 6683</strong>
<a class="qa-opening-hours" href="../../../../../support/index.html" itemprop="openingHours">See our opening hours</a>
</div>
<div class="mobile-show">
<a class="has-nav icon-phone js-notice-toggle qa-mobile-customer-service-number site-header__call-button" data-track="mobile_call_button" href="tel:0333 014 6683" id="qa-mobile-customer-service-button"></a>
</div>
</div>
</div>
<i class="site-header__menu-icon icon-menu desktop-hide js-menu-toggle"></i>
</div>
<nav class="primary-nav">
<div class="grid-wrapper">
<ul class="menu--top">
<li class="menu__item menu__item--menu js-submenu portable-hide">
<a class="menu__item-link" href="../../../../../insurance/index.html">Business insurance</a>
<div class="menu__panel-container">
<div class="menu__panel js-menu-panel">
<div class="grid-wrapper">
<div class="grid"><div class="grid-cell desktop-3">
<h3>
<a href="../../../../../insurance/index.html">Business insurance</a>
</h3>
</div><div class="grid-cell desktop-3">
<h3>
<a href="../../../../../insurance/covers/index.html">Business insurance covers</a>
</h3>
<ul class="menu__sublist">
<li>
<a href="../../../../../insurance/public-liability/index.html">Public liability insurance</a>
</li>
<li>
<a href="../../../../../insurance/professional-indemnity/index.html">Professional indemnity insurance</a>
</li>
<li>
<a href="../../../../../insurance/employers-liability/index.html">Employers' liability insurance</a>
</li>
<li>
<a href="../../../../../insurance/tool-cover/index.html">Tool insurance</a>
</li>
<li>
<a href="../../../../../insurance/business-contents/index.html">Business contents insurance</a>
</li>
<li>
<a href="../../../../../insurance/business-buildings/index.html">Business building insurance</a>
</li>
<li>
<a href="../../../../../insurance/personal-accident-insurance/index.html">Personal accident insurance</a>
</li>
<li>
<a href="../../../../../insurance/stock-cover/index.html">Stock insurance</a>
</li>
<li>
<a href="../../../../../insurance/covers/index.html">More business covers</a>
</li>
</ul>
</div><div class="grid-cell desktop-3">
<h3>
<a href="../../../../../insurance/business-types/index.html">Insurance by business type</a>
</h3>
<ul class="menu__sublist">
<li>
<a href="../../../../../insurance/self-employed/index.html">Self-employed insurance</a>
</li>
<li>
<a href="../../../../../insurance/contractors/index.html">Contractor insurance</a>
</li>
<li>
<a href="../../../../../insurance/limited-company-insurance/index.html">Limited company insurance</a>
</li>
<li>
<a href="../../../../../insurance/home-business/index.html">Home business insurance</a>
</li>
<li>
<a href="../../../../../insurance/online-retailers/index.html">Online retailer insurance</a>
</li>
<li>
<a href="../../../../../insurance/consultants/index.html">Consultant insurance</a>
</li>
<li>
<a href="../../../../../insurance/freelancers/index.html">Freelancer insurance</a>
</li>
<li>
<a href="../../../../../insurance/sole-trader/index.html">Sole trader insurance</a>
</li>
<li>
<a href="../../../../../insurance/business-types/index.html">More business types</a>
</li>
</ul>
</div><div class="grid-cell desktop-3">
<h3>
<a href="../../../../../insurance/by-industry/index.html">Insurance by trade</a>
</h3>
<ul class="menu__sublist">
<li>
<a href="../../../../../insurance/cleaners/index.html">Cleaners' insurance</a>
</li>
<li>
<a href="../../../../../insurance/hairdressers/index.html">Hairdressing insurance</a>
</li>
<li>
<a href="../../../../../insurance/catering/index.html">Catering insurance</a>
</li>
<li>
<a href="../../../../../insurance/photographers/index.html">Photographers' insurance</a>
</li>
<li>
<a href="../../../../../insurance/shop/index.html">Shop insurance</a>
</li>
<li>
<a href="../../../../../insurance/dog-walkers/index.html">Dog walking insurance</a>
</li>
<li>
<a href="../../../../../insurance/tradesman/index.html">Tradesman insurance</a>
</li>
<li>
<a href="../../../../../insurance/massage/index.html">Massage therapists' insurance</a>
</li>
<li>
<a href="../../../../../insurance/by-industry/index.html">More trades</a>
</li>
</ul>
</div></div>
</div>
</div>
</div>
</li>
<li class="menu__item menu__item--menu js-submenu portable-show">
<a class="menu__item-link" href="../../../../../insurance/index.html">Business insurance</a>
<div class="menu__panel-container">
<div class="menu__panel js-menu-panel">
<ul class="menu__sublist">
<li>
<a href="../../../../../insurance/index.html">Business insurance</a>
</li>
<li>
<a href="../../../../../insurance/public-liability/index.html">Public liability insurance</a>
</li>
<li>
<a href="../../../../../insurance/professional-indemnity/index.html">Professional indemnity insurance</a>
</li>
<li>
<a href="../../../../../insurance/employers-liability/index.html">Employers' liability insurance</a>
</li>
<li>
<a href="../../../../../insurance/tool-cover/index.html">Tool insurance</a>
</li>
<li>
<a href="../../../../../insurance/covers/index.html">More business covers</a>
</li>
<li>
<a href="../../../../../insurance/by-industry/index.html">Insurance by industry</a>
</li>
<li>
<a href="../../../../../insurance/business-types/index.html">Insurance by business type</a>
</li>
</ul>
</div>
</div>
</li>
<li class="menu__item menu__item--menu js-submenu portable-hide">
<a class="menu__item-link" href="../../../../../landlord-insurance/index.html">Landlord insurance</a>
<div class="menu__panel-container">
<div class="menu__panel js-menu-panel">
<div class="grid-wrapper">
<div class="grid"><div class="grid-cell desktop-3">
<h3>
<a href="../../../../../landlord-insurance/index.html">Landlord insurance</a>
</h3>
</div><div class="grid-cell desktop-3">
<h3>
<a href="../../../../../landlord-insurance/landlord-covers/index.html">Landlord insurance covers</a>
</h3>
<ul class="menu__sublist">
<li>
<a href="../../../../../landlord-insurance/buy-to-let-insurance/index.html">Buy-to-let insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/content-insurance/index.html">Landlord contents insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/loss-of-rent-insurance/index.html">Loss of rent insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/liability-insurance/index.html">Landlord liability insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/accidental-damage/index.html">Accidental damage insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/alternative-accommodation/index.html">Alternative accommodation insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/unoccupied-property-insurance/index.html">Unoccupied property insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/tenant-default-insurance/index.html">Tenant default insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/landlord-covers/index.html">More landlord covers</a>
</li>
</ul>
</div><div class="grid-cell desktop-3">
<h3>Property types</h3>
<ul class="menu__sublist">
<li>
<a href="../../../../../landlord-insurance/residential-landlord-insurance/index.html">Residential landlord insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/commercial-landlord-insurance/index.html">Commercial landlord insurance</a>
</li>
</ul>
</div></div>
</div>
</div>
</div>
</li>
<li class="menu__item menu__item--menu js-submenu portable-show">
<a class="menu__item-link" href="../../../../../landlord-insurance/index.html">Landlord insurance</a>
<div class="menu__panel-container">
<div class="menu__panel js-menu-panel">
<ul class="menu__sublist">
<li>
<a href="../../../../../landlord-insurance/index.html">Landlord insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/buy-to-let-insurance/index.html">Buy-to-let insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/content-insurance/index.html">Landlord contents insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/loss-of-rent-insurance/index.html">Loss of rent insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/liability-insurance/index.html">Landlord liability insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/accidental-damage/index.html">Accidental damage insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/unoccupied-property-insurance/index.html">Unoccupied property insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/landlord-covers/index.html">More covers</a>
</li>
</ul>
</div>
</div>
</li>
<li class="menu__item menu__item--menu js-submenu portable-hide">
<a class="menu__item-link" href="../../../../../knowledge/index.html">Knowledge centre</a>
<div class="menu__panel-container">
<div class="menu__panel js-menu-panel">
<div class="grid-wrapper">
<div class="grid"><div class="grid-cell desktop-3">
<h3>
<a href="../../../../../knowledge/index.html">Knowledge centre</a>
</h3>
</div><div class="grid-cell desktop-3">
<h3>
<a href="../../../../../knowledge/index.html">Articles</a>
</h3>
<ul class="menu__sublist">
<li>
<a href="../../../../../knowledge/popular-articles/index.html">Most popular articles</a>
</li>
<li>
<a href="../../../../../knowledge/index.html">All articles</a>
</li>
</ul>
</div><div class="grid-cell desktop-3">
<h3>
<a href="../../../../../microsites/index.html">Microsites</a>
</h3>
<ul class="menu__sublist">
<li>
<a href="../../../../../microsites/facebook-for-small-businesses/index.html">Facebook for small businesses</a>
</li>
<li>
<a href="../../../../../microsites/google-my-business-guide/index.html">Google My Business guide</a>
</li>
<li>
<a href="../../../../../microsites/google-analytics-guide/index.html">Google Analytics guide</a>
</li>
<li>
<a href="../../../../../microsites/google-adwords/index.html">Google Adwords guide</a>
</li>
<li>
<a href="../../../../../microsites/twitter-for-small-businesses/index.html">Twitter for small businesses</a>
</li>
<li>
<a href="../../../../../microsites/email-marketing-guide/index.html">Email marketing guide</a>
</li>
<li>
<a href="../../../../../microsites/guide-to-social-media-success/index.html">Guide to social media success</a>
</li>
<li>
<a href="../../../../../microsites/googleplus-for-small-businesses/index.html">GooglePlus for small businesses</a>
</li>
<li>
<a href="../../../../../microsites/index.html">More microsites</a>
</li>
</ul>
</div><div class="grid-cell desktop-3">
<h3>FAQ</h3>
<ul class="menu__sublist">
<li>
<a href="../../../../../insurance/faq/index.html">Business insurance FAQ</a>
</li>
<li>
<a href="../../../../../landlord-insurance/faq/index.html">Landlord insurance FAQ</a>
</li>
</ul>
</div></div>
</div>
</div>
</div>
</li>
<li class="menu__item menu__item--menu js-submenu portable-show">
<a class="menu__item-link" href="../../../../../knowledge/index.html">Knowledge centre</a>
<div class="menu__panel-container">
<div class="menu__panel js-menu-panel">
<ul class="menu__sublist">
<li>
<a href="../../../../../knowledge/index.html">Knowledge centre</a>
</li>
<li>
<a href="../../../../../knowledge/popular-articles/index.html">Most popular articles</a>
</li>
<li>
<a href="../../../../../microsites/index.html">Microsites</a>
</li>
<li>
<a href="../../../../../knowledge/resources/small-business-guides/index.html">Small business guides</a>
</li>
<li>
<a href="../../../../../insurance/faq/index.html">Business insurance FAQ</a>
</li>
<li>
<a href="../../../../../landlord-insurance/faq/index.html">Landlord insurance FAQ</a>
</li>
</ul>
</div>
</div>
</li>
<li class="menu__item">
<a class="menu__item-link" href="../../../../../support/index.html">Help & support</a>
</li>
<li class="menu__item">
<a class="menu__item-link qa-make-a-claim-menu" data-track="make_a_claim_button_clicked" href="../../../../../insurance-claims/index.html">Claims</a>
</li>
<li class="menu__item">
<a class="menu__item-link" data-track="sign_in_button_clicked" href="../../../../../signin/index.html">Sign in</a>
</li>
</ul>
</div>
</nav>




</header>
<section class="site-section grid-wrapper">
<div class="archive grid"><div class="archive__main grid-cell desktop-twothirds">
<article class="article" itemscope itemtype="https://schema.org/Blog">
<header class="article__header">
<div class="dateline" itemprop="datePublished"> 8 November 2014</div>
<h1 id="qa-page-heading" itemprop="name">Hackathon: Building a Sales Leaderboard with RabbitFeed and Websockets</h1>
<p class="byline" itemprop="author">By Joshua Fleck</p>

<div class="social-tools addthis_sharing_toolbox"></div>
</header>
<div class="article__body" itemprop="blogPost">
&#x000A;<p>As mentioned in <a href="../../10/centralised-event-logging-with-rabbitfeed/index.html" >this post</a>, we’ve been aligning our approach to business intelligence with our <a href="../../../../careers/architecture-manifesto/index.html" >architectural principles</a>. One of our hypotheses was that by taking an event-based approach to analytics we would be able to be more agile with our data. In order to test this hypothesis, we needed a ‘killer-app’ that would not only prove the approach, but also help us sell it to the rest of the business.</p>&#x000A;&#x000A;<h2>Finding a Killer-App</h2>&#x000A;&#x000A;<p>We sell our product via two primary channels: online and offline. Our offline channel is served by a contact centre in our Northampton office. Sales consultants call potential customers and attempt to make sales over the phone. Previously, whenever consultants made sales, they would have to get up from their desks, walk to their team’s white board, and manually record the sale.</p>&#x000A;&#x000A;<p>Our idea for the ‘killer-app’ was to utilise the wall boards scattered about the contact centre for displaying a sales leaderboard fed by events from our back office system. Not only would this remove an inefficient manual step in the sales process, it would also foster a sense of friendly competition amongst consultants (we hoped).</p>&#x000A;&#x000A;<h2>The Leaderboard</h2>&#x000A;&#x000A;<p>The leaderboard is a simple ranking of consultants by the total value of the product that they have sold for the day. Rankings can be split out by teams to show consultants not only how they rank with the rest of the contact centre, but also within their own team. It looks something like this (note that this is sample data):</p>&#x000A;&#x000A;<p><img src="../../../../../media/tech/hackathon-building-a-sales-leaderboard-with-rabbitfeed-and-websockets/leaderboard.png" alt="The leaderboard" /></p>&#x000A;&#x000A;<h2>How it Works</h2>&#x000A;&#x000A;<p>Whenever a consultant completes a sale on our back office system, it publishes a sales event. The leaderboard application subscribes to these sales events. Once a sales event is consumed, it is immediately pushed up to the leaderboard.</p>&#x000A;&#x000A;<h3>The Sales Event</h3>&#x000A;&#x000A;<p>The event publish/subscribe is performed using <a target="_blank" href="https://github.com/simplybusiness/rabbit_feed" >RabbitFeed</a>.</p>&#x000A;&#x000A;<h4>Publishing</h4>&#x000A;&#x000A;<p>The event publish is done at the point the consultant completes a sale in the back office. This event is then available to any downstream application for consumption.</p>&#x000A;&#x000A;<p>The sales event is defined in the RabbitFeed initialiser like this:</p>&#x000A;&#x000A;<pre><code class="language-ruby">EventDefinitions do&#x000A;  define_event('consultant_completes_sale', version: '0.0.1') do&#x000A;    defined_as do&#x000A;      %w{&#x000A;        A consultant has completed a sale in the back office.&#x000A;      }&#x000A;    end&#x000A;    payload_contains do&#x000A;      field('consultant', type: 'string', definition: 'The name of the consultant')&#x000A;      field('team', type: 'string', definition: 'The name of the team to which the consultant belongs')&#x000A;      field('amount', type: 'string', definition: 'The amount of the sale, in dollars')&#x000A;    end&#x000A;  end&#x000A;end&#x000A;</code></pre>&#x000A;&#x000A;<p>The event is published from the Rails controller:</p>&#x000A;&#x000A;<pre><code class="language-ruby">class SalesController &lt; ApplicationController&#x000A;&#x000A;  def create&#x000A;    sale = Sale.new sale_params&#x000A;    if sale.save&#x000A;      RabbitFeed::Producer.publish_event 'consultant_completes_sale', {&#x000A;        consultant: sale.consultant.name,&#x000A;        team:       sale.consultant.team,&#x000A;        amount:     sale.amount,&#x000A;      }&#x000A;      ...&#x000A;    else&#x000A;      ...&#x000A;    end&#x000A;  end&#x000A;end&#x000A;</code></pre>&#x000A;&#x000A;<h4>Subscribing</h4>&#x000A;&#x000A;<p>A RabbitFeed consumer process runs in the Rails environment on the leaderboard server. This process will apply the sale to the day’s rankings and will push the update to the clients.</p>&#x000A;&#x000A;<p>The subscription is configured in the RabbitFeed initialiser like this:</p>&#x000A;&#x000A;<pre><code class="language-ruby">EventRouting do&#x000A;  accept_from('back office') do&#x000A;    event('consultant_completes_sale') do |event|&#x000A;      (EventHander.new event).update_leaderboard&#x000A;    end&#x000A;  end&#x000A;end&#x000A;</code></pre>&#x000A;&#x000A;<p>When an event is consumed, a consultant ranking record is found or initialised and the sale is applied to the consultant’s ranking. The updated ranking is then pushed up to the clients. The event handling code looks like this:</p>&#x000A;&#x000A;<pre><code class="language-ruby">class EventHandler&#x000A;&#x000A;  attr_reader :event&#x000A;&#x000A;  def initialize event&#x000A;    @event = event&#x000A;  end&#x000A;&#x000A;  def update_leaderboard&#x000A;    consultant_ranking.record_sale! event.amount&#x000A;    push_to_clients&#x000A;  end&#x000A;&#x000A;  private&#x000A;&#x000A;  def consultant_ranking&#x000A;    @consultant_ranking ||= ConsultantRanking.find_or_initialize_by(&#x000A;      consultant: event.consultant,&#x000A;      team:       event.team,&#x000A;      date:       (Time.parse event.transacted_at_utc).to_date,&#x000A;    )&#x000A;  end&#x000A;&#x000A;  def push_to_clients&#x000A;    ...&#x000A;  end&#x000A;end&#x000A;</code></pre>&#x000A;&#x000A;<h3>Updating the Leaderboard</h3>&#x000A;&#x000A;<p>At any one time, there will be 10-15 clients displaying the leaderboard in a browser window. There are a few options available for updating the leaderboard with new data and sales. We could simply trigger the browser to refresh the page at specified time intervals, but this method doesn’t afford any interactivity or excitement when new data is displayed. Alternatively, we could have each client continuously poll the server for updates, but this requires the client to maintain some state about the updates it has processed. We wanted a mechanism by which all clients would be updated simultaneously and instantaneously whenever a sale was made. This allows the client to apply any updates to the leaderboard with a flash! We were able to achieve this via the use of <a target="_blank" href="https://github.com/websocket-rails/websocket-rails" >Web Sockets</a>.</p>&#x000A;&#x000A;<h4>Configuration</h4>&#x000A;&#x000A;<p>First, we need to add the <code >websocket-rails</code> gem to our leaderboard application:</p>&#x000A;&#x000A;<pre><code class="language-ruby">gem 'websocket-rails'&#x000A;</code></pre>&#x000A;&#x000A;<p>Next, we need to enable the RabbitFeed consumer process to trigger websocket events. Because the RabbitFeed consumer process is asynchronous, it runs as a separate process outside of the leaderboard web application. We needed a means for websocket events triggered within the RabbitFeed consumer process to be sent to clients connected to the leaderboard web application. Fortunately, <code >websocket-rails</code> has this capability built-in: Using <a target="_blank" href="http://redis.io/" >Redis</a>, a websocket event triggered on one process will be pushed onto Redis and synchronised to the other process.</p>&#x000A;&#x000A;<p>Set this configuration option in the websocket-rails initialiser to enable websocket synchronisation:</p>&#x000A;&#x000A;<pre><code class="language-ruby"># Change to true to enable channel synchronization between&#x000A;# multiple server instances.&#x000A;# * Requires Redis.&#x000A;config.synchronize = true&#x000A;</code></pre>&#x000A;&#x000A;<p>The websocket event will be published to the <code >consultant_ranking</code> channel. The clients will subscribe to this channel. The event is published by calling <code >trigger</code> with the <code >change</code> event and a payload. The client handler will bind to this event type. The code to trigger the websocket event looks like this:</p>&#x000A;&#x000A;<pre><code class="language-ruby">class EventHandler&#x000A;&#x000A;  ...&#x000A;&#x000A;  def push_to_clients&#x000A;    WebsocketRails[:consultant_ranking].trigger :change, {&#x000A;      consultant:    consultant_ranking.consultant,&#x000A;      team:          consultant_ranking.team,&#x000A;      units_sold:    consultant_ranking.units_sold,&#x000A;      sales_revenue: consultant_ranking.sales_revenue,&#x000A;      ranking:       consultant_ranking.ranking,&#x000A;    }&#x000A;  end&#x000A;end&#x000A;</code></pre>&#x000A;&#x000A;<p>On the client side, we create a websocket pointing back to the websocket URL on our server. We then subscribe to the <code >consultant_ranking</code> channel and define a handler function for <code >change</code> events. The event handler will be called for every change event triggered on the server. The event handler will apply the change in ranking to the leaderboard with a flash. The code looks like this:</p>&#x000A;&#x000A;<pre><code class="language-javascript">// Create the socket&#x000A;// The socket URL looks something like this: http://localhost:3000/websocket&#x000A;var dispatcher = new WebSocketRails(window.location.host+'/websocket');&#x000A;&#x000A;// Subscribe to the websocket channel on which we publish the events&#x000A;var channel = dispatcher.subscribe('consultant_ranking');&#x000A;&#x000A;// Declare the event handler&#x000A;// Bind to the 'change' channel event&#x000A;channel.bind('change', function(consultant_ranking) {&#x000A;&#x000A;  // This is what gets called when an event is received&#x000A;  update_consultant_ranking(consultant_ranking);&#x000A;&#x000A;};&#x000A;&#x000A;</code></pre>&#x000A;&#x000A;<h3>Performance</h3>&#x000A;&#x000A;<p>Due to the distributed nature of the design, there are no bottlenecks between the back office application and the leaderboard. As soon as a sales event is published, the leaderboard subscriber consumes the event and pushes it up to the clients. In fact, the sale often registers on the leaderboard before the back office system can load the post-sale page!</p>&#x000A;&#x000A;<h2>Outcome</h2>&#x000A;&#x000A;<p>The leaderboard was an instant success: Sales consultants began vying for the top ranking on the leaderboard, team managers were able to get immediate feedback on the performance of their team members, and senior management gained improved insight on who the top performers in the contact centre were. The leaderboard proved that an event-based approach to analytics would allow us to be more agile with our data. Additional applications were soon built using the same approach. For example, we created a daily sales dashboard showing stats on the day’s sales, split by the online and offline channels as well as a business KPI monitoring and alerting system.</p>&#x000A;&#x000A;<p>Find out more about how you can use <a target="_blank" href="https://github.com/simplybusiness/rabbit_feed" >RabbitFeed</a> to unlock the potential of your <a href="../../10/centralised-event-logging-with-rabbitfeed/index.html" >data</a></p>&#x000A;</div>
<footer class="article__footer">
<div class="social-tools addthis_sharing_toolbox"></div>
</footer>
</article>
<div class="comment-box">
<div id="disqus_thread"></div>
<script>
  var disqus_shortname = 'simplybusiness';
  var disqus_url = 'index.html';
  
  var original_orientation_change = window.onorientationchange;
  
  window.onorientationchange = function () {
    if (DISQUS) {
      DISQUS.reset({
        reload: true,
        config: function () {
          this.page.url = disqus_url;
        }
      });
    }
  
    if (original_orientation_change) {
      original_orientation_change();
    }
  };
  
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
</div>

</div><div class="grid-cell desktop-onethird">
<div class="newsletter-signup-module" id="qa-newsletter-signup-module">
<div class="newsletter-signup-module__content">
<h3>Join over 350,000 subscribers to our monthly newsletter</h3>
<p>
Keep up to date with the breaking news, guides and tips impacting your
business or rental.
</p>
<a class="btn small btn-primary" href="../../../../newsletter-signup/index.html" id="qa-newsletter-signup-module-cta">Subscribe</a>
</div>
</div>

<nav class="archive__nav" id="qa-archive-nav">

<div class="archive__nav-section qa-archive-nav-section" id="qa-archive-years-nav">
<h2>Archive</h2>
<ul class="in-columns">
<li>
<a href="../../../2017/index.html">2017</a>
</li>
<li>
<a href="../../../2016/index.html">2016</a>
</li>
<li>
<a href="../../../2015/index.html">2015</a>
</li>
<li>
<a href="/">2014</a>
</li>
<li>
<a href="../../../2013/index.html">2013</a>
</li>
<li>
<a href="../../../2012/index.html">2012</a>
</li>
</ul>
</div>

</nav>
</div></div>

</section>
<section class="site-section grid-wrapper sitemap">
<div class="grid"><div class="grid-cell desktop-onesixth tablet-onethird mobile-onehalf">
<div class="module">
<div class="module-content">
<h4>Insurance</h4>
<ul>
<li>
<a href="../../../../../insurance/public-liability/index.html">Public liability insurance</a>
</li>
<li>
<a href="../../../../../insurance/index.html">Business insurance</a>
</li>
<li>
<a href="../../../../../landlord-insurance/index.html">Landlord insurance</a>
</li>
<li>
<a href="../../../../../insurance/tradesman/index.html">Tradesman insurance</a>
</li>
<li>
<a href="../../../../../insurance/professionals/index.html">Professionals' insurance</a>
</li>
<li>
<a href="../../../../../insurance/shop/index.html">Shop insurance</a>
</li>
<li>
<a href="../../../../../insurance/restaurant/index.html">Restaurant insurance</a>
</li>
<li>
<a href="../../../../../vehicle/van-insurance/index.html">Van insurance</a>
</li>
<li>
<a href="../../../../../insurance/insurers/index.html">Insurers</a>
</li>
</ul>
</div>
</div>
</div><div class="grid-cell desktop-onesixth tablet-onethird mobile-onehalf">
<div class="module">
<div class="module-content">
<h4>About company name</h4>
<ul>
<li>
<a href="../../../../index.html">About us</a>
</li>
<li>
<a href="../../../../team/index.html">Our team</a>
</li>
<li>
<a href="../../../../awards/index.html">Awards</a>
</li>
<li>
<a href="../../../../press-releases/index.html">Press releases</a>
</li>
<li>
<a href="../../../../../partner/index.html">Partners &amp; affiliates</a>
</li>
<li>
<a href="../../../../impact/index.html">Impact charity program</a>
</li>
<li>
<a href="../../../../../social/index.html">Social media</a>
</li>
</ul>
</div>
</div>
</div><div class="grid-cell desktop-onesixth tablet-onethird mobile-onehalf">
<div class="module">
<div class="module-content">
<h4>Careers</h4>
<ul>
<li>
<a href="../../../../careers/index.html">Careers at company name</a>
</li>
<li>
<a href="../../../../careers/tech/index.html">Tech careers</a>
</li>
<li>
<a href="../../../../careers/jobs/index.html">Current vacancies</a>
</li>
</ul>
</div>
</div>
</div><div class="grid-cell desktop-onesixth tablet-onethird mobile-onehalf">
<div class="module">
<div class="module-content">
<h4>Customer support</h4>
<ul>
<li>
<a href="../../../../../support/index.html">Contact &amp; support</a>
</li>
<li>
<a href="../../../../../support/indexa064.html?topic=renewal">Policy renewal</a>
</li>
<li>
<a href="../../../../../insurance-claims/index.html">Make a claim</a>
</li>
<li>
<a href="../../../../../proof/index.html">Proof of policy</a>
</li>
<li>
<a href="../../../../../support/complaints/index.html">Complaints</a>
</li>
</ul>
</div>
</div>
</div><div class="grid-cell desktop-onesixth tablet-onethird mobile-onehalf">
<div class="module">
<div class="module-content">
<h4>Benefits</h4>
<ul>
<li>
<a href="../../../../../support/customer-benefits/index.html">Benefits</a>
</li>
<li>
<a href="../../../../refer/index.html">Refer a friend</a>
</li>
<li>
<a href="../../../../../finance/index.html">Finance</a>
</li>
</ul>
</div>
</div>
</div><div class="grid-cell desktop-onesixth tablet-onethird mobile-onehalf">
<div class="module">
<div class="module-content">
<h4>Knowledge</h4>
<ul>
<li>
<a href="../../../../../knowledge/index.html">Knowledge centre</a>
</li>
<li>
<a href="../../../../../knowledge/opinion/index.html">Opinions</a>
</li>
<li>
<a href="../../../../../microsites/index.html">Microsites</a>
</li>
<li>
<a href="../../../../../leaderboards/top-100-influencers-small-business/index.html">Business 100 leaderboard</a>
</li>
<li>
<a href="../../../../../leaderboards/top-100-influencers-property/index.html">Property 100 leaderboard</a>
</li>
</ul>
</div>
</div>
</div></div>
</section>




<footer class="site-footer">
<div class="grid-wrapper">
<div class="grid"><div class="grid-cell desktop-onethird tablet-onehalf vcard">
<h3 class="fn">Address</h3>
<p>
<span class="adr" itemprop="address">
99 Gresham Street<br>
London<br>
EC2V 7NG
</span>
</p>
<p>
<span class="adr" itemprop="address">
Sol House<br>
29 St Katherine's Street<br>
Northampton<br>
NN1 2QZ
</span>
</p>
</div><div class="grid-cell desktop-twothirds tablet-onehalf">
<div class="grid desktop-reverse"><div class="grid-cell desktop-onethird legal">
<h3>Legal</h3>
<ul>
<li>
<a href="../../../../../terms-conditions/index.html" target="">Terms &amp; conditions</a>
</li>
<li>
<a href="../../../../../privacy-policy/index.html" target="">Privacy policy</a>
</li>
<li>
<a href="../../../../../legal/cookies/index.html" target="">Cookie policy</a>
</li>
<li>
<a href="../../../../../sitemap/index.html" target="">Site map</a>
</li>
</ul>
</div><div class="grid-cell desktop-twothirds newsletter">
<h3>Newsletter</h3>
<p>
Sign up to get our monthly newsletter, jam-packed with industry news, tips and events.
</p>
<a class="btn-tertiary" href="../../../../newsletter-signup/index.html" target="">Subscribe</a>
</div></div>
</div>
</div>
</div>
<div class="small-print">
<div class="grid-wrapper">
<p>
&copy; Copyright 2017 company name. All Rights Reserved.
company name is a trading name of Xbridge Limited which is authorised and
regulated by the Financial Conduct Authority (Financial Services Registration
No: 313348). Xbridge Limited (No: 3967717) has its registered office at
99 Gresham Street, London EC2V 7NG.
</p>
</div>
</div>
</footer>
<script src="../../../../../assets/app-eda58eafa7598e80d09818bcdb51d1bc8b5fd8ad045ebf777e843726ae3171b3.js"></script>
<script id="snippet-twitter" src="../../../../../../static.ads-twitter.com/oct.js"></script>
<script>
  if (window.twttr) twttr.conversion.trackPid('l65zb', { tw_sale_amount: 0, tw_order_quantity: 0 });
</script>
<noscript>
<img alt="" height="1" src="https://analytics.twitter.com/i/adsct?txn_id=l65zb&amp;p_id=Twitter&amp;tw_sale_amount=0&amp;tw_order_quantity=0" style="display:none;" width="1">
<img alt="" height="1" src="http://t.co/i/adsct?txn_id=l65zb&amp;p_id=Twitter&amp;tw_sale_amount=0&amp;tw_order_quantity=0" style="display:none;" width="1">
</noscript>
<script id="snippet-addthis" src="../../../../../../s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4e98360a319de2dd"></script>
<script id="snippet-linkedin">
var _bizo_data_partner_id = "7577";
(function() {
var s = document.getElementsByTagName("script")[0];
var b = document.createElement("script");
b.type = "text/javascript";
b.async = true;
b.src = (window.location.protocol === "https:" ? "https://sjs" : "http://js") + ".bizographics.com/insight.min.js";
s.parentNode.insertBefore(b, s);
})();
</script>
<noscript>
<img height="1" src="http://www.bizographics.com/collect/?pid=7577&amp;fmt=gif" style="display:none;" width="1">
</noscript>
<!-- begin usabilla live embed code -->
<script id="snippet-usabilla">
window.lightningjs||function(c){function g(b,d){d&&(d+=(/\?/.test(d)?"&":"?")+"lv=1");c[b]||function(){var i=window,h=document,j=b,g=h.location.protocol,l="load",k=0;(function(){function b(){a.P(l);a.w=1;c[j]("_load")}c[j]=function(){function m(){m.id=e;return c[j].apply(m,arguments)}var b,e=++k;b=this&&this!=i?this.id||0:0;(a.s=a.s||[]).push([e,b,arguments]);m.then=function(b,c,h){var d=a.fh[e]=a.fh[e]||[],j=a.eh[e]=a.eh[e]||[],f=a.ph[e]=a.ph[e]||[];b&&d.push(b);c&&j.push(c);h&&f.push(h);return m};return m};var a=c[j]._={};a.fh={};a.eh={};a.ph={};a.l=d?d.replace(/^\/\//,(g=="https:"?g:"http:")+"//"):d;a.p={0:+new Date};a.P=function(b){a.p[b]=new Date-a.p[0]};a.w&&b();i.addEventListener?i.addEventListener(l,b,!1):i.attachEvent("on"+l,b);var q=function(){function b(){return["<head></head><",c,' onload="var d=',n,";d.getElementsByTagName('head')[0].",d,"(d.",g,"('script')).",i,"='",a.l,"'\"></",c,">"].join("")}var c="body",e=h[c];if(!e)return setTimeout(q,100);a.P(1);var d="appendChild",g="createElement",i="src",k=h[g]("div"),l=k[d](h[g]("div")),f=h[g]("iframe"),n="document",p;k.style.display="none";e.insertBefore(k,e.firstChild).id=o+"-"+j;f.frameBorder="0";f.id=o+"-frame-"+j;/MSIE[ ]+6/.test(navigator.userAgent)&&(f[i]="javascript:false");f.allowTransparency="true";l[d](f);try{f.contentWindow[n].open()}catch(s){a.domain=h.domain,p="javascript:var d="+n+".open();d.domain='"+h.domain+"';",f[i]=p+"void(0);"}try{var r=f.contentWindow[n];r.write(b());r.close()}catch(t){f[i]=p+'d.write("'+b().replace(/"/g,String.fromCharCode(92)+'"')+'");d.close();'}a.P(2)};a.l&&setTimeout(q,0)})()}();c[b].lv="1";return c[b]}var o="lightningjs",k=window[o]=g(o);k.require=g;k.modules=c}({});
if(!navigator.userAgent.match(/Android|BlackBerry|BB10|iPhone|iPad|iPod|Opera Mini|IEMobile/i)) {window.usabilla_live = lightningjs.require("usabilla_live", "../../../../../../w.usabilla.com/d9aa21c6f852.js"); } else {window.usabilla_live = lightningjs.require("usabilla_live", "../../../../../../w.usabilla.com/c627832b68ee.js"); }
window.usabilla_live('data', {custom: {domain_userid: 'd05a8d5d8c09756c'}});
</script>
<!-- end usabilla live embed code -->




</body>

<!-- Mirrored from www.simplybusiness.co.uk/about-us/tech/2014/11/hackathon-building-a-sales-leaderboard-with-rabbitfeed-and-websockets/ by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 04 Dec 2017 10:13:42 GMT -->
</html>

